/**
 * Happy Place Theme - Archive Filters Component
 * 
 * Advanced filtering interface for listings
 */

.hph-filters {
    @include card-base;
    padding: var(--hph-spacing-6);
    margin-bottom: var(--hph-spacing-8);
    
    .filters-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--hph-spacing-6);
        padding-bottom: var(--hph-spacing-4);
        border-bottom: 1px solid var(--color-border-light);
        
        .filters-title {
            font-size: var(--hph-font-size-lg);
            font-weight: var(--font-weight-semibold);
            color: var(--color-text);
            margin: 0;
            
            i {
                margin-right: var(--hph-spacing-2);
                color: var(--color-primary);
            }
        }
        
        .filters-toggle {
            display: none;
            
            @include respond-below('lg') {
                display: flex;
                align-items: center;
                gap: var(--hph-spacing-2);
                padding: var(--hph-spacing-2) var(--hph-spacing-4);
                background: var(--color-surface);
                color: var(--color-text);
                border: 1px solid var(--color-border);
                border-radius: var(--hph-border-radius-lg);
                cursor: pointer;
                transition: var(--transition-fast);
                
                &:hover {
                    background: var(--color-primary-light);
                    color: var(--color-primary-dark);
                    border-color: var(--color-primary);
                }
                
                .toggle-icon {
                    transition: transform var(--transition-fast);
                }
                
                &.expanded .toggle-icon {
                    transform: rotate(180deg);
                }
            }
        }
        
        .clear-filters {
            display: flex;
            align-items: center;
            gap: var(--hph-spacing-2);
            padding: var(--hph-spacing-2) var(--hph-spacing-4);
            background: none;
            color: var(--color-text-muted);
            border: none;
            border-radius: var(--hph-border-radius-lg);
            font-size: var(--hph-font-size-sm);
            cursor: pointer;
            transition: var(--transition-fast);
            
            &:hover {
                background: var(--color-surface);
                color: var(--color-text);
            }
            
            &:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }
        }
    }
    
    .filters-content {
        @include respond-below('lg') {
            &.collapsed {
                display: none;
            }
        }
    }
    
    // Filter Groups
    .filter-group {
        margin-bottom: var(--hph-spacing-6);
        
        &:last-child {
            margin-bottom: 0;
        }
        
        .filter-group-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--hph-spacing-4);
            cursor: pointer;
            
            .group-label {
                font-weight: var(--font-weight-semibold);
                color: var(--color-text);
                font-size: var(--hph-font-size-md);
                
                i {
                    margin-right: var(--hph-spacing-2);
                    color: var(--color-primary);
                    width: 1rem;
                    text-align: center;
                }
            }
            
            .group-toggle {
                color: var(--color-text-muted);
                transition: transform var(--transition-fast);
                
                &.collapsed {
                    transform: rotate(-90deg);
                }
            }
        }
        
        .filter-group-content {
            transition: var(--transition-medium);
            
            &.collapsed {
                display: none;
            }
        }
    }
    
    // Filter Types
    .filter-checkboxes,
    .filter-radio {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--hph-spacing-3);
        
        @include respond-below('md') {
            grid-template-columns: 1fr;
        }
        
        .filter-option {
            display: flex;
            align-items: center;
            gap: var(--hph-spacing-3);
            padding: var(--hph-spacing-3);
            background: var(--color-surface);
            border: 1px solid var(--color-border-light);
            border-radius: var(--hph-border-radius-lg);
            cursor: pointer;
            transition: var(--transition-fast);
            
            &:hover {
                background: var(--color-primary-light);
                border-color: var(--color-primary);
            }
            
            &.active {
                background: var(--color-primary);
                color: var(--color-white);
                border-color: var(--color-primary);
            }
            
            input[type="checkbox"],
            input[type="radio"] {
                margin: 0;
                cursor: pointer;
            }
            
            .option-label {
                flex: 1;
                font-weight: var(--font-weight-medium);
                cursor: pointer;
            }
            
            .option-count {
                font-size: var(--hph-font-size-sm);
                color: var(--color-text-muted);
                
                .active & {
                    color: rgb(255 255 255 / 80%);
                }
            }
        }
    }
    
    // Range Filters
    .filter-range {
        .range-inputs {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: var(--hph-spacing-3);
            align-items: center;
            margin-bottom: var(--hph-spacing-4);
            
            input {
                @include form-input;
                text-align: center;
            }
            
            .range-separator {
                color: var(--color-text-muted);
                font-weight: var(--font-weight-medium);
            }
        }
        
        .range-slider {
            position: relative;
            height: 6px;
            background: var(--color-border-light);
            border-radius: var(--hph-border-radius-full);
            margin: var(--hph-spacing-4) 0;
            
            .range-track {
                position: absolute;
                height: 100%;
                background: var(--color-primary);
                border-radius: var(--hph-border-radius-full);
            }
            
            .range-thumb {
                position: absolute;
                width: 1.25rem;
                height: 1.25rem;
                background: var(--color-primary);
                border: 2px solid var(--color-white);
                border-radius: var(--hph-border-radius-full);
                top: 50%;
                transform: translate(-50%, -50%);
                cursor: pointer;
                box-shadow: var(--shadow-sm);
                transition: var(--transition-fast);
                
                &:hover,
                &:focus {
                    transform: translate(-50%, -50%) scale(1.1);
                    box-shadow: var(--shadow-md);
                }
            }
        }
        
        .range-labels {
            display: flex;
            justify-content: space-between;
            font-size: var(--hph-font-size-sm);
            color: var(--color-text-muted);
            margin-top: var(--hph-spacing-2);
        }
    }
    
    // Select Filters
    .filter-select {
        select {
            @include form-input;
            width: 100%;
        }
        
        &.multi-select {
            .select-options {
                max-height: 200px;
                overflow-y: auto;
                border: 1px solid var(--color-border);
                border-radius: var(--hph-border-radius-lg);
                background: var(--color-white);
                
                .select-option {
                    display: flex;
                    align-items: center;
                    gap: var(--hph-spacing-3);
                    padding: var(--hph-spacing-3);
                    cursor: pointer;
                    transition: var(--transition-fast);
                    
                    &:hover {
                        background: var(--color-surface);
                    }
                    
                    &.selected {
                        background: var(--color-primary-light);
                        color: var(--color-primary-dark);
                    }
                    
                    input[type="checkbox"] {
                        margin: 0;
                    }
                }
            }
        }
    }
    
    // Active Filters
    .active-filters {
        margin-top: var(--hph-spacing-6);
        padding-top: var(--hph-spacing-6);
        border-top: 1px solid var(--color-border-light);
        
        .active-filters-title {
            font-weight: var(--font-weight-semibold);
            color: var(--color-text);
            margin-bottom: var(--hph-spacing-4);
            font-size: var(--hph-font-size-sm);
        }
        
        .active-filters-list {
            display: flex;
            flex-wrap: wrap;
            gap: var(--hph-spacing-2);
            
            .active-filter {
                display: flex;
                align-items: center;
                gap: var(--hph-spacing-2);
                padding: var(--hph-spacing-2) var(--hph-spacing-3);
                background: var(--color-primary-light);
                color: var(--color-primary-dark);
                border-radius: var(--hph-border-radius-xl);
                font-size: var(--hph-font-size-sm);
                font-weight: var(--font-weight-medium);
                
                .filter-remove {
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    width: 1rem;
                    height: 1rem;
                    background: rgb(0 0 0 / 10%);
                    border-radius: var(--hph-border-radius-full);
                    cursor: pointer;
                    transition: var(--transition-fast);
                    
                    &:hover {
                        background: rgb(0 0 0 / 20%);
                    }
                    
                    i {
                        font-size: 0.6rem;
                    }
                }
            }
        }
    }
    
    // Filter Actions
    .filter-actions {
        display: flex;
        gap: var(--hph-spacing-4);
        margin-top: var(--hph-spacing-6);
        padding-top: var(--hph-spacing-6);
        border-top: 1px solid var(--color-border-light);
        
        @include respond-below('sm') {
            flex-direction: column;
        }
        
        .apply-filters-btn {
            @include button-primary;
            flex: 1;
        }
        
        .reset-filters-btn {
            @include button-outline;
            flex: 1;
        }
        
        .save-search-btn {
            @include button-outline;
            white-space: nowrap;
            
            @include respond-below('sm') {
                order: -1;
            }
        }
    }
    
    // Loading State
    &.loading {
        opacity: 0.7;
        pointer-events: none;
        
        .filter-actions {
            position: relative;
            
            &::after {
                content: '';
                position: absolute;
                top: 50%;
                left: 50%;
                width: 1.5rem;
                height: 1.5rem;
                margin: -0.75rem 0 0 -0.75rem;
                border: 2px solid var(--color-border-light);
                border-top-color: var(--color-primary);
                border-radius: var(--hph-border-radius-full);
                animation: spin 1s linear infinite;
            }
        }
    }
}

// Sidebar Filters (when used in sidebar)
.sidebar .hph-filters {
    padding: var(--hph-spacing-5);
    
    .filter-group {
        margin-bottom: var(--hph-spacing-5);
    }
    
    .filter-checkboxes,
    .filter-radio {
        grid-template-columns: 1fr;
    }
    
    .filter-actions {
        flex-direction: column;
        gap: var(--hph-spacing-3);
    }
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
