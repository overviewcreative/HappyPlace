{
    "key": "group_relationships_listings",
    "title": "Listing Relationships",
    "fields": [
        {
            "key": "field_agent_relationships_tab",
            "label": "Agent Relationships",
            "name": "",
            "type": "tab",
            "placement": "top",
            "endpoint": 0
        },
        {
            "key": "field_listing_agent",
            "label": "Primary Listing Agent",
            "name": "listing_agent",
            "type": "post_object",
            "instructions": "Primary agent responsible for this listing",
            "required": 1,
            "wrapper": {
                "width": "50",
                "class": "",
                "id": ""
            },
            "post_type": ["agent"],
            "taxonomy": [],
            "allow_null": 0,
            "multiple": 0,
            "return_format": "object",
            "ui": 1
        },
        {
            "key": "field_co_listing_agent",
            "label": "Co-Listing Agent",
            "name": "co_listing_agent",
            "type": "post_object",
            "instructions": "Secondary listing agent (if applicable)",
            "required": 0,
            "wrapper": {
                "width": "50",
                "class": "",
                "id": ""
            },
            "post_type": ["agent"],
            "taxonomy": [],
            "allow_null": 1,
            "multiple": 0,
            "return_format": "object",
            "ui": 1
        },
        {
            "key": "field_buyer_agent",
            "label": "Buyer's Agent",
            "name": "buyer_agent",
            "type": "post_object",
            "instructions": "Buyer's agent (for sold/pending properties)",
            "required": 0,
            "wrapper": {
                "width": "50",
                "class": "",
                "id": ""
            },
            "post_type": ["agent"],
            "taxonomy": [],
            "allow_null": 1,
            "multiple": 0,
            "return_format": "object",
            "ui": 1,
            "conditional_logic": [
                [
                    {
                        "field": "field_status",
                        "operator": "==",
                        "value": "sold"
                    }
                ],
                [
                    {
                        "field": "field_status", 
                        "operator": "==",
                        "value": "pending"
                    }
                ]
            ]
        },
        {
            "key": "field_referring_agent",
            "label": "Referring Agent",
            "name": "referring_agent",
            "type": "post_object",
            "instructions": "Agent who referred this listing (if applicable)",
            "required": 0,
            "wrapper": {
                "width": "50",
                "class": "",
                "id": ""
            },
            "post_type": ["agent"],
            "taxonomy": [],
            "allow_null": 1,
            "multiple": 0,
            "return_format": "object",
            "ui": 1
        },
        {
            "key": "field_location_relationships_tab",
            "label": "Location Relationships",
            "name": "",
            "type": "tab",
            "placement": "top",
            "endpoint": 0
        },
        {
            "key": "field_related_city",
            "label": "City",
            "name": "related_city",
            "type": "post_object",
            "instructions": "City where this property is located",
            "required": 1,
            "wrapper": {
                "width": "50",
                "class": "",
                "id": ""
            },
            "post_type": ["city"],
            "taxonomy": [],
            "allow_null": 0,
            "multiple": 0,
            "return_format": "object",
            "ui": 1
        },
        {
            "key": "field_related_community",
            "label": "Community/Subdivision",
            "name": "related_community",
            "type": "post_object",
            "instructions": "Community or subdivision (if applicable)",
            "required": 0,
            "wrapper": {
                "width": "50",
                "class": "",
                "id": ""
            },
            "post_type": ["community"],
            "taxonomy": [],
            "allow_null": 1,
            "multiple": 0,
            "return_format": "object",
            "ui": 1
        },
        {
            "key": "field_nearby_listings",
            "label": "Similar Nearby Listings",
            "name": "nearby_listings",
            "type": "relationship",
            "instructions": "Other listings in the same area or price range",
            "required": 0,
            "post_type": ["listing"],
            "taxonomy": [],
            "filters": ["search", "post_type"],
            "elements": ["featured_image"],
            "min": 0,
            "max": 10,
            "return_format": "object"
        },
        {
            "key": "field_transaction_relationships_tab",
            "label": "Transaction Relationships",
            "name": "",
            "type": "tab",
            "placement": "top",
            "endpoint": 0
        },
        {
            "key": "field_related_transaction",
            "label": "Related Transaction",
            "name": "related_transaction",
            "type": "post_object",
            "instructions": "Transaction record for this listing (if applicable)",
            "required": 0,
            "wrapper": {
                "width": "100",
                "class": "",
                "id": ""
            },
            "post_type": ["transaction"],
            "taxonomy": [],
            "allow_null": 1,
            "multiple": 0,
            "return_format": "object",
            "ui": 1
        },
        {
            "key": "field_open_houses",
            "label": "Scheduled Open Houses",
            "name": "scheduled_open_houses",
            "type": "relationship",
            "instructions": "Open houses scheduled for this property",
            "required": 0,
            "post_type": ["open-house"],
            "taxonomy": [],
            "filters": ["search"],
            "elements": [],
            "min": 0,
            "max": 20,
            "return_format": "object"
        },
        {
            "key": "field_client_relationships_tab",
            "label": "Client Relationships",
            "name": "",
            "type": "tab",
            "placement": "top",
            "endpoint": 0
        },
        {
            "key": "field_listing_clients",
            "label": "Listing Clients",
            "name": "listing_clients",
            "type": "repeater",
            "instructions": "Sellers/owners of this property",
            "required": 0,
            "min": 0,
            "max": 10,
            "layout": "table",
            "button_label": "Add Client",
            "sub_fields": [
                {
                    "key": "field_client_name",
                    "label": "Client Name",
                    "name": "client_name",
                    "type": "text",
                    "wrapper": {"width": "30"},
                    "required": 1
                },
                {
                    "key": "field_client_role",
                    "label": "Role",
                    "name": "client_role",
                    "type": "select",
                    "wrapper": {"width": "20"},
                    "choices": {
                        "seller": "Seller",
                        "co_seller": "Co-Seller",
                        "estate": "Estate",
                        "trustee": "Trustee",
                        "executor": "Executor",
                        "power_of_attorney": "Power of Attorney"
                    },
                    "default_value": "seller"
                },
                {
                    "key": "field_client_email",
                    "label": "Email",
                    "name": "client_email",
                    "type": "email",
                    "wrapper": {"width": "25"}
                },
                {
                    "key": "field_client_phone",
                    "label": "Phone",
                    "name": "client_phone",
                    "type": "text",
                    "wrapper": {"width": "25"}
                }
            ]
        },
        {
            "key": "field_interested_buyers",
            "label": "Interested Buyers",
            "name": "interested_buyers",
            "type": "repeater",
            "instructions": "Track interested buyers and showings",
            "required": 0,
            "min": 0,
            "max": 50,
            "layout": "table",
            "button_label": "Add Interested Buyer",
            "sub_fields": [
                {
                    "key": "field_buyer_name",
                    "label": "Buyer Name",
                    "name": "buyer_name",
                    "type": "text",
                    "wrapper": {"width": "25"}
                },
                {
                    "key": "field_buyer_agent_name",
                    "label": "Buyer's Agent",
                    "name": "buyer_agent_name",
                    "type": "text",
                    "wrapper": {"width": "25"}
                },
                {
                    "key": "field_interest_level",
                    "label": "Interest Level",
                    "name": "interest_level",
                    "type": "select",
                    "wrapper": {"width": "20"},
                    "choices": {
                        "inquiry": "Initial Inquiry",
                        "showing": "Requested Showing",
                        "viewed": "Viewed Property",
                        "interested": "Very Interested",
                        "offer": "Made Offer",
                        "declined": "Declined"
                    }
                },
                {
                    "key": "field_last_contact",
                    "label": "Last Contact",
                    "name": "last_contact",
                    "type": "date_picker",
                    "wrapper": {"width": "15"},
                    "display_format": "M j, Y",
                    "return_format": "Y-m-d"
                },
                {
                    "key": "field_buyer_notes",
                    "label": "Notes",
                    "name": "buyer_notes",
                    "type": "textarea",
                    "wrapper": {"width": "15"},
                    "rows": 2
                }
            ]
        }
    ],
    "location": [
        [
            {
                "param": "post_type",
                "operator": "==",
                "value": "listing"
            }
        ]
    ],
    "menu_order": 5,
    "position": "normal",
    "style": "default",
    "label_placement": "top",
    "instruction_placement": "label",
    "active": true,
    "description": "Manages all relationships between listings and agents, locations, transactions, and clients.",
    "show_in_rest": true
}